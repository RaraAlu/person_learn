### [使用键盘控制fishbot](https://fishros.com/d2lros2/#/humble/chapt9/get_started/4.Gazebo仿真插件之两轮差速?id=_43-使用键盘控制fishbot)

```shell
>安装
sudo apt install ros-humble-teleop-twist-keyboard
>启动
ros2 run teleop_twist_keyboard teleop_twist_keyboard

```

#### [保存地图](https://fishros.com/d2lros2/#/humble/chapt10/get_started/3.配置FishBot进行建图?id=_62-保存地图)

```shell
ros2 run nav2_map_server map_saver_cli --help
当前目录：/home/ls/ls/ROS/chapt5/chapt8_ws/
# 先将地图保存到src/fishbot_cartographer/map目录下
cd src/fishbot_cartographer/ && mkdir map && cd map
ros2 run nav2_map_server map_saver_cli -t map -f fishbot_map

UDP>>
ros2 run micro_ros_agent micro_ros_agent udp4 --port 8888 -v6
Serial>>
ros2 run micro_ros_agent micro_ros_agent serial -b 921600 --dev /dev/ttyUSB0 -v

```

#### 板卡设置

```
xhost + && sudo docker run -it --rm --privileged -v /dev:/dev -v /tmp/.X11-unix:/tmp/.X11-unix -e DISPLAY=unix$DISPLAY fishros2/fishbot-tool:v1.0.0.20230108 python3 main.py
```



## [查看机器人当前在地图中的位置](https://fishros.com/d2lros2/#/humble/chapt11/get_started/3.使用FishBot进行自主导航?id=_7查看机器人当前在地图中的位置)

```shell
ros2 run tf2_ros  tf2_echo map base_link
```

#### Ros2 for Docker

```shell
# UDPv4 micro-ROS Agent
docker run -it --rm -v /dev:/dev -v /dev/shm:/dev/shm --privileged --net=host microros/micro-ros-agent:$ROS_DISTRO udp4 --port 8888 -v6

# Serial micro-ROS Agent
docker run -it --rm -v /dev:/dev -v /dev/shm:/dev/shm --privileged --net=host microros/micro-ros-agent:$ROS_DISTRO serial --dev /dev/ttyUSB0 -v6

# TCPv4 micro-ROS Agent
docker run -it --rm -v /dev:/dev -v /dev/shm:/dev/shm --privileged --net=host microros/micro-ros-agent:$ROS_DISTRO tcp4 --port 8888 -v6

# CAN-FD micro-ROS Agent
docker run -it --rm -v /dev:/dev -v /dev/shm:/dev/shm --privileged --net=host microros/micro-ros-agent:$ROS_DISTRO canfd --dev [YOUR CAN INTERFACE] -v6

# 雷达docker
xhost + && sudo docker run  -it --rm  -v /dev:/dev -v /dev/shm:/dev/shm --privileged  -v /tmp/.X11-unix:/tmp/.X11-unix --device /dev/snd -e DISPLAY=unix$DISPLAY -p 8889:8888 registry.cn-hangzhou.aliyuncs.com/fishros/fishbot_laser
```

#### Gazebo启动

```shell
gazebo --verbose -s libgazebo_ros_init.so -s libgazebo_ros_factory.so 
```



#### Arduino配置

```shell
Adafruit ESP32 Feather

lib_deps = 
    https://gitee.com/ohhuo/micro_ros_platformio.git
```

#### 运行建图

```shell
ros2 launch slam_toolbox online_async_launch.py 
```

#### 一顿操作就建图

```
cd /home/ls/ls/PERSONAL_ROS/fishbot
. install/setup.bash
ros2 launch fishbot_bringup fishbot_bringup.launch.py 
docker run -it --rm -v /dev:/dev -v /dev/shm:/dev/shm --privileged --net=host microros/micro-ros-agent:$ROS_DISTRO udp4 --port 8888 -v6
xhost + && sudo docker run  -it --rm  -v /dev:/dev -v /dev/shm:/dev/shm --privileged  -v /tmp/.X11-unix:/tmp/.X11-unix --device /dev/snd -e DISPLAY=unix$DISPLAY -p 8889:8888 registry.cn-hangzhou.aliyuncs.com/fishros/fishbot_laser
》开启slaml
ros2 launch slam_toolbox online_async_launch.py 
》开启键盘遥控
ros2 run teleop_twist_keyboard teleop_twist_keyboard
》到地图目录保存地图
cd /home/ls/ls/PERSONAL_ROS/fishbot/src/fishbot_navigation2/maps

ros2 run nav2_map_server map_saver_cli -t map -f fishbot_map


```

```
2023-11-28 06:34:55 > [操作]切换设备类型FishBot主控板|MicroROS学习板
2023-11-28 06:35:02 > [提示]获取到当前设备为motion_board
2023-11-28 06:35:02 > [提示]读取到配置项first_startup->0
2023-11-28 06:35:02 > [提示]读取到配置项serial_baud->921600
2023-11-28 06:35:02 > [提示]读取到配置项serial_id->0
2023-11-28 06:35:02 > [提示]读取到配置项wifi_ssid->boen
2023-11-28 06:35:02 > [提示]读取到配置项wifi_pswd->12345678
2023-11-28 06:35:02 > [提示]读取到配置项wifi_ap_ssid->FISHBOT_FDEC
2023-11-28 06:35:02 > [提示]读取到配置项wifi_ap_pswd->
2023-11-28 06:35:02 > [提示]读取到配置项microros_mode->udp_client
2023-11-28 06:35:02 > [提示]读取到配置项udpserver_ip->192.168.3.8
2023-11-28 06:35:02 > [提示]读取到配置项udpserver_port->8888
2023-11-28 06:35:02 > [提示]读取到配置项ros2_nodename->fishbot_motion_control
2023-11-28 06:35:02 > [提示]读取到配置项ros2_namespace->
2023-11-28 06:35:02 > [提示]读取到配置项odom_topic->odom
2023-11-28 06:35:02 > [提示]读取到配置项odom_frameid->odom
2023-11-28 06:35:02 > [提示]读取到配置项odom_c_frameid->base_link
2023-11-28 06:35:02 > [提示]读取到配置项twist_topic->cmd_vel
2023-11-28 06:35:02 > [提示]读取到配置项odom_pub_period->50
2023-11-28 06:35:02 > [提示]读取到配置项reducate_ration->30.00
2023-11-28 06:35:02 > [提示]读取到配置项pulse_ration->51
2023-11-28 06:35:02 > [提示]读取到配置项wheel_diameter->84
2023-11-28 06:35:02 > [提示]读取到配置项wheel_distance->167.50
2023-11-28 06:35:02 > [提示]读取到配置项pid_kp->0.62
2023-11-28 06:35:02 > [提示]读取到配置项pid_ki->0.13
2023-11-28 06:35:02 > [提示]读取到配置项pid_kd->0.00
2023-11-28 06:35:02 > [提示]读取到配置项pid_outlimit->100.00
2023-11-28 06:35:02 > [提示]读取到配置项version->v1.1.0
```

```
latpoint = [22.7049595, 22.7049685, 22.70497800, 22.7049874, ...
22.7049925, 22.7049832, 22.7049737, 22.7049650, ...
22.7049698, 22.7049783, 22.7049882, 22.7049977, ...
22.7050018, 22.7049928, 22.7049825, 22.7049744, ];
lonpoint = [114.2436170, 114.2436249, 114.2436329, 114.2436411, ...
114.2436340, 114.2436257, 114.2436170, 114.2436098, ...
114.2436031, 114.2436095, 114.2436179, 114.2436270, ...
114.2436212, 114.2436121, 114.2436032, 114.2435964];
```

